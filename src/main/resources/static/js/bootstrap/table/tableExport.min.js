!function(t){t.fn.extend({tableExport:function(e){function n(t,e,n){var o="";if(null!==t){var r=x(t,e,n),i=null===r||""===r?"":r.toString();"tsv"==W.type?(r instanceof Date&&r.toLocaleString(),o=w(i,"	"," ")):r instanceof Date?o=W.csvEnclosure+r.toLocaleString()+W.csvEnclosure:(o=w(i,W.csvEnclosure,W.csvEnclosure+W.csvEnclosure),(o.indexOf(W.csvSeparator)>=0||/[\r\n ]/g.test(o))&&(o=W.csvEnclosure+o+W.csvEnclosure))}return o}function o(e){var n=[];return r(e,"tbody").each(function(){n.push.apply(n,i(t(this),W.tbodySelector))}),W.tfootSelector.length&&r(e,"tfoot").each(function(){n.push.apply(n,i(t(this),W.tfootSelector))}),n}function r(e,n){var o=e.parents("table").length;return e.find(n).filter(function(){return t(this).closest("table").parents("table").length===o})}function i(e,n){return e.find(n).filter(function(){return 0===t(this).find("table").length&&1===t(this).parents("table").length})}function a(e){var n=[];return t(e).find("thead").first().find("th").each(function(e,o){n[e]=void 0!==t(o).attr("data-field")?t(o).attr("data-field"):e.toString()}),n}function s(e){var n="undefined"!=typeof e[0].cellIndex,o="undefined"!=typeof e[0].rowIndex,r=n||o?l(e):e.is(":visible"),i=e.data("tableexport-display");return n&&"none"!=i&&"always"!=i&&(e=t(e[0].parentNode),o="undefined"!=typeof e[0].rowIndex,i=e.data("tableexport-display")),o&&"none"!=i&&"always"!=i&&(i=e.closest("table").data("tableexport-display")),"none"!==i&&(1==r||"always"==i)}function l(t){var e=[];return Y&&(e=V.filter(function(){var e=!1;return this.nodeType==t[0].nodeType&&("undefined"!=typeof this.rowIndex&&this.rowIndex==t[0].rowIndex?e=!0:"undefined"!=typeof this.cellIndex&&this.cellIndex==t[0].cellIndex&&"undefined"!=typeof this.parentNode.rowIndex&&"undefined"!=typeof t[0].parentNode.rowIndex&&this.parentNode.rowIndex==t[0].parentNode.rowIndex&&(e=!0)),e})),0==Y||0==e.length}function c(e,n,o){var r=!1;return s(e)?W.ignoreColumn.length>0&&(-1!=t.inArray(o,W.ignoreColumn)||-1!=t.inArray(o-n,W.ignoreColumn)||q.length>o&&"undefined"!=typeof q[o]&&-1!=t.inArray(q[o],W.ignoreColumn))&&(r=!0):r=!0,r}function d(e,n,o,r,i){if("function"==typeof i){var a=!1;if("function"==typeof W.onIgnoreRow&&(a=W.onIgnoreRow(t(e),o)),a===!1&&-1==t.inArray(o,W.ignoreRow)&&-1==t.inArray(o-r,W.ignoreRow)&&s(t(e))){var l=t(e).find(n),d=0;l.each(function(e){var n,r=t(this),a=parseInt(this.getAttribute("colspan")),s=parseInt(this.getAttribute("rowspan"));if(Q.forEach(function(t){if(o>=t.s.r&&o<=t.e.r&&d>=t.s.c&&d<=t.e.c)for(n=0;n<=t.e.c-t.s.c;++n)i(null,o,d++)}),c(r,l.length,e)===!1&&((s||a)&&(s=s||1,a=a||1,Q.push({s:{r:o,c:d},e:{r:o+s-1,c:d+a-1}})),i(this,o,d++)),a)for(n=0;a-1>n;++n)i(null,o,d++)}),Q.forEach(function(t){if(o>=t.s.r&&o<=t.e.r&&d>=t.s.c&&d<=t.e.c)for(he=0;he<=t.e.c-t.s.c;++he)i(null,o,d++)})}}}function f(t,e){if(W.consoleLog===!0&&console.log(t.output()),"string"===W.outputMode)return t.output();if("base64"===W.outputMode)return P(t.output());if("window"===W.outputMode)return window.URL=window.URL||window.webkitURL,void window.open(window.URL.createObjectURL(t.output("blob")));try{var n=t.output("blob");saveAs(n,W.fileName+".pdf")}catch(o){L(W.fileName+".pdf","data:application/pdf"+(e?"":";base64")+",",e?t.output("blob"):t.output())}}function h(t,e,n){var o=0;if("undefined"!=typeof n&&(o=n.colspan),o>=0){for(var r=t.width,i=t.textPos.x,a=e.table.columns.indexOf(e.column),s=1;o>s;s++){var l=e.table.columns[a+s];r+=l.width}if(o>1&&("right"===t.styles.halign?i=t.textPos.x+r-t.width:"center"===t.styles.halign&&(i=t.textPos.x+(r-t.width)/2)),t.width=r,t.textPos.x=i,"undefined"!=typeof n&&n.rowspan>1&&(t.height=t.height*n.rowspan),"middle"===t.styles.valign||"bottom"===t.styles.valign){var c="string"==typeof t.text?t.text.split(/\r\n|\r|\n/g):t.text,d=c.length||1;d>2&&(t.textPos.y-=(2-F)/2*e.row.styles.fontSize*(d-2)/3)}return!0}return!1}function u(e,n,o){"undefined"!=typeof o.images&&n.each(function(){var n=t(this).children();if(t(this).is("img")){var r=D(this.src);o.images[r]={url:this.src,src:this.src}}"undefined"!=typeof n&&n.length>0&&u(e,n,o)})}function p(t,e){function n(){e(i)}function o(t){if(t.url){var e=new Image;i=++a,e.crossOrigin="Anonymous",e.onerror=e.onload=function(){if(e.complete&&(0===e.src.indexOf("data:image/")&&(e.width=t.width||e.width||0,e.height=t.height||e.height||0),e.width+e.height)){var o=document.createElement("canvas"),r=o.getContext("2d");o.width=e.width,o.height=e.height,r.drawImage(e,0,0),t.src=o.toDataURL("image/jpeg")}--a||n()},e.src=t.url}}var r,i=0,a=0;if("undefined"!=typeof t.images)for(r in t.images)t.images.hasOwnProperty(r)&&o(t.images[r]);return a||n()}function g(e,n,o){n.each(function(){var n=t(this).children(),r=0;if(t(this).is("div")){var i=C(N(this,"background-color"),[255,255,255]),a=C(N(this,"border-top-color"),[0,0,0]),s=T(this,"border-top-width",W.jspdf.unit),l=this.getBoundingClientRect(),c=this.offsetLeft*o.dw;r=this.offsetTop*o.dh;var d=l.width*o.dw,f=l.height*o.dh;o.doc.setDrawColor.apply(void 0,a),o.doc.setFillColor.apply(void 0,i),o.doc.setLineWidth(s),o.doc.rect(e.x+c,e.y+r,d,f,s?"FD":"F")}else if(t(this).is("img")&&"undefined"!=typeof o.images){var h=D(this.src),u=o.images[h];if("undefined"!=typeof u){var p=e.width/e.height,m=this.width/this.height,y=e.width,w=e.height,v=19.049976/25.4;p>=m?(w=Math.min(e.height,this.height),y=this.width*w/this.height):m>p&&(y=Math.min(e.width,this.width),w=this.height*y/this.width),y*=v,w*=v,w<e.height&&(r=(e.height-w)/2);try{o.doc.addImage(u.src,e.textPos.x,e.y+r,y,w)}catch(b){}e.textPos.x+=y}}"undefined"!=typeof n&&n.length>0&&g(e,n,o)})}function m(e,n,o){if("function"==typeof o.onAutotableText)o.onAutotableText(o.doc,e,n);else{var r=e.textPos.x,i=e.textPos.y,a={halign:e.styles.halign,valign:e.styles.valign};if(n.length){for(var s=n[0];s.previousSibling;)s=s.previousSibling;for(var l=!1,c=!1;s;){var d=s.innerText||s.textContent||"";d=(d.length&&" "==d[0]?" ":"")+t.trim(d)+(d.length>1&&" "==d[d.length-1]?" ":""),t(s).is("br")&&(r=e.textPos.x,i+=o.doc.internal.getFontSize()),t(s).is("b")?l=!0:t(s).is("i")&&(c=!0),(l||c)&&o.doc.setFontType(l&&c?"bolditalic":l?"bold":"italic");var f=o.doc.getStringUnitWidth(d)*o.doc.internal.getFontSize();if(f){if("linebreak"===e.styles.overflow&&r>e.textPos.x&&r+f>e.textPos.x+e.width){var h=".,!%*;:=-";if(h.indexOf(d.charAt(0))>=0){var u=d.charAt(0);f=o.doc.getStringUnitWidth(u)*o.doc.internal.getFontSize(),r+f<=e.textPos.x+e.width&&(o.doc.autoTableText(u,r,i,a),d=d.substring(1,d.length)),f=o.doc.getStringUnitWidth(d)*o.doc.internal.getFontSize()}r=e.textPos.x,i+=o.doc.internal.getFontSize()}for(;d.length&&r+f>e.textPos.x+e.width;)d=d.substring(0,d.length-1),f=o.doc.getStringUnitWidth(d)*o.doc.internal.getFontSize();o.doc.autoTableText(d,r,i,a),r+=f}(l||c)&&(t(s).is("b")?l=!1:t(s).is("i")&&(c=!1),o.doc.setFontType(l||c?l?"bold":"italic":"normal")),s=s.nextSibling}e.textPos.x=r,e.textPos.y=i}else o.doc.autoTableText(e.text,e.textPos.x,e.textPos.y,a)}}function y(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function w(t,e,n){return t.replace(new RegExp(y(e),"g"),n)}function v(t){return t=t||"0",t=w(t,W.numbers.html.thousandsSeparator,""),t=w(t,W.numbers.html.decimalMark,"."),"number"==typeof t||jQuery.isNumeric(t)!==!1?t:!1}function b(t){return t.indexOf("%")>-1?(t=v(t.replace(/%/g,"")),t!==!1&&(t/=100)):t=!1,t}function x(e,n,o){var r="";if(null!==e){var i,a=t(e);if(a[0].hasAttribute("data-tableexport-value"))i=a.data("tableexport-value"),i=i?i+"":"";else if(i=a.html(),"function"==typeof W.onCellHtmlData)i=W.onCellHtmlData(a,n,o,i);else if(""!=i){var s=t.parseHTML(i),l=0,c=0;i="",t.each(s,function(){t(this).is("input")?i+=a.find("input").eq(l++).val():t(this).is("select")?i+=a.find("select option:selected").eq(c++).text():"undefined"==typeof t(this).html()?i+=t(this).text():(void 0===jQuery().bootstrapTable||t(this).hasClass("filterControl")!==!0&&0===t(e).parents(".detail-view").length)&&(i+=t(this).html())})}if(W.htmlContent===!0)r=t.trim(i);else if(i&&""!=i){var d=t(e).data("tableexport-cellformat");if(""!=d){var f=i.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"⁠"),h=t("<div/>").html(f).contents(),u=!1;if(f="",t.each(h.text().split("\u2028"),function(e,n){e>0&&(f+=" "),f+=t.trim(n)}),t.each(f.split("⁠"),function(e,n){e>0&&(r+="\n"),r+=t.trim(n).replace(/\u00AD/g,"")}),"json"==W.type||"excel"===W.type&&"xmlss"===W.excelFileFormat||W.numbers.output===!1)u=v(r),u!==!1&&(r=Number(u));else if((W.numbers.html.decimalMark!=W.numbers.output.decimalMark||W.numbers.html.thousandsSeparator!=W.numbers.output.thousandsSeparator)&&(u=v(r),u!==!1)){var p=(""+u.substr(0>u?1:0)).split(".");1==p.length&&(p[1]="");var g=p[0].length>3?p[0].length%3:0;r=(0>u?"-":"")+(W.numbers.output.thousandsSeparator?(g?p[0].substr(0,g)+W.numbers.output.thousandsSeparator:"")+p[0].substr(g).replace(/(\d{3})(?=\d)/g,"$1"+W.numbers.output.thousandsSeparator):p[0])+(p[1].length?W.numbers.output.decimalMark+p[1]:"")}}else r=i}W.escape===!0&&(r=escape(r)),"function"==typeof W.onCellData&&(r=W.onCellData(a,n,o,r))}return r}function S(t,e,n){return e+"-"+n.toLowerCase()}function C(t,e){var n=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,o=n.exec(t),r=e;return o&&(r=[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]),r}function k(e){var n=N(e,"text-align"),o=N(e,"font-weight"),r=N(e,"font-style"),i="";"start"==n&&(n="rtl"==N(e,"direction")?"right":"left"),o>=700&&(i="bold"),"italic"==r&&(i+=r),""===i&&(i="normal");var a={style:{align:n,bcolor:C(N(e,"background-color"),[255,255,255]),color:C(N(e,"color"),[0,0,0]),fstyle:i},colspan:parseInt(t(e).attr("colspan"))||0,rowspan:parseInt(t(e).attr("rowspan"))||0};if(null!==e){var s=e.getBoundingClientRect();a.rect={width:s.width,height:s.height}}return a}function N(t,e){try{return window.getComputedStyle?(e=e.replace(/([a-z])([A-Z])/,S),window.getComputedStyle(t,null).getPropertyValue(e)):t.currentStyle?t.currentStyle[e]:t.style[e]}catch(n){}return""}function A(t,e,n){var o=100,r=document.createElement("div");r.style.overflow="hidden",r.style.visibility="hidden",t.appendChild(r),r.style.width=o+n;var i=o/r.offsetWidth;return t.removeChild(r),e*i}function T(t,e,n){var o=N(t,e),r=o.match(/\d+/);return null!==r?(r=r[0],A(t.parentElement,r,n)):0}function R(){return this instanceof R?(this.SheetNames=[],void(this.Sheets={})):new R}function I(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}function E(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function j(t){for(var e={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=t.length;++o)for(var r=0;r!=t[o].length;++r){n.s.r>o&&(n.s.r=o),n.s.c>r&&(n.s.c=r),n.e.r<o&&(n.e.r=o),n.e.c<r&&(n.e.c=r);var i={v:t[o][r]};if(null!==i.v){var a=XLSX.utils.encode_cell({c:r,r:o});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=XLSX.SSF._table[14],i.v=E(i.v)):i.t="s",e[a]=i}}return n.s.c<1e7&&(e["!ref"]=XLSX.utils.encode_range(n)),e}function D(t){var e,n,o,r=0;if(0===t.length)return r;for(e=0,o=t.length;o>e;e++)n=t.charCodeAt(e),r=(r<<5)-r+n,r|=0;return r}function L(t,e,n){var o=window.navigator.userAgent;if(t!==!1&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([n]),t);else if(t!==!1&&(o.indexOf("MSIE ")>0||o.match(/Trident.*rv\:11\./))){var r=document.createElement("iframe");r&&(document.body.appendChild(r),r.setAttribute("style","display:none"),r.contentDocument.open("txt/html","replace"),r.contentDocument.write(n),r.contentDocument.close(),r.focus(),r.contentDocument.execCommand("SaveAs",!0,t),document.body.removeChild(r))}else{var i=document.createElement("a");if(i){var a=null;i.style.display="none",t!==!1?i.download=t:i.target="_blank","object"==typeof n?(window.URL=window.URL||window.webkitURL,a=window.URL.createObjectURL(n),i.href=a):i.href=e.toLowerCase().indexOf("base64,")>=0?e+P(n):e+encodeURIComponent(n),document.body.appendChild(i),document.createEvent?(null===B&&(B=document.createEvent("MouseEvents")),B.initEvent("click",!0,!1),i.dispatchEvent(B)):document.createEventObject?i.fireEvent("onclick"):"function"==typeof i.onclick&&i.onclick(),setTimeout(function(){a&&window.URL.revokeObjectURL(a),document.body.removeChild(i)},100)}}}function M(t){if("string"==typeof t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",n=0;n<t.length;n++){var o=t.charCodeAt(n);128>o?e+=String.fromCharCode(o):o>127&&2048>o?(e+=String.fromCharCode(o>>6|192),e+=String.fromCharCode(63&o|128)):(e+=String.fromCharCode(o>>12|224),e+=String.fromCharCode(o>>6&63|128),e+=String.fromCharCode(63&o|128))}return e}return t}function P(t){var e,n,o,r,i,a,s,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0;for(t=M(t);d<t.length;)e=t.charCodeAt(d++),n=t.charCodeAt(d++),o=t.charCodeAt(d++),r=e>>2,i=(3&e)<<4|n>>4,a=(15&n)<<2|o>>6,s=63&o,isNaN(n)?a=s=64:isNaN(o)&&(s=64),c=c+l.charAt(r)+l.charAt(i)+l.charAt(a)+l.charAt(s);return c}var O,W={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelFileFormat:"xlshtml",excelRTL:!1,excelstyles:[],exportHiddenCells:!1,fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},onDocCreated:null,autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{doc:null,onAfterAutotable:null,onBeforeAutotable:null,onAutotableText:null,onTable:null,outputImages:!0}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,onIgnoreRow:null,onMsoNumberFormat:null,outputMode:"file",pdfmake:{enabled:!1,docDefinition:{pageOrientation:"portrait",defaultStyle:{font:"Roboto"}},fonts:{}},tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"Table",type:"csv",worksheetName:""},F=1.15,U=this,B=null,H=[],z=[],K=0,X="",q=[],Q=[],V=[],Y=!1;if(t.extend(!0,W,e),q=a(U),"csv"==W.type||"tsv"==W.type||"txt"==W.type){var $="",_=0;Q=[],K=0;var G=function(e,o,r){return e.each(function(){X="",d(this,o,K,r+e.length,function(t,e,o){X+=n(t,e,o)+("tsv"==W.type?"	":W.csvSeparator)}),X=t.trim(X).substring(0,X.length-1),X.length>0&&($.length>0&&($+="\n"),$+=X),K++}),e.length};if(_+=G(t(U).find("thead").first().find(W.theadSelector),"th,td",_),r(t(U),"tbody").each(function(){_+=G(i(t(this),W.tbodySelector),"td,th",_)}),W.tfootSelector.length&&G(t(U).find("tfoot").first().find(W.tfootSelector),"td,th",_),$+="\n",W.consoleLog===!0&&console.log($),"string"===W.outputMode)return $;if("base64"===W.outputMode)return P($);if("window"===W.outputMode)return void L(!1,"data:text/"+("csv"==W.type?"csv":"plain")+";charset=utf-8,",$);try{O=new Blob([$],{type:"text/"+("csv"==W.type?"csv":"plain")+";charset=utf-8"}),saveAs(O,W.fileName+"."+W.type,"csv"!=W.type||W.csvUseBOM===!1)}catch(J){L(W.fileName+"."+W.type,"data:text/"+("csv"==W.type?"csv":"plain")+";charset=utf-8,"+("csv"==W.type&&W.csvUseBOM?"﻿":""),$)}}else if("sql"==W.type){K=0,Q=[];var Z="INSERT INTO `"+W.tableName+"` (";if(H=t(U).find("thead").first().find(W.theadSelector),H.each(function(){d(this,"th,td",K,H.length,function(t,e,n){Z+="'"+x(t,e,n)+"',"}),K++,Z=t.trim(Z),Z=t.trim(Z).substring(0,Z.length-1)}),Z+=") VALUES ",z=o(t(U)),t(z).each(function(){X="",d(this,"td,th",K,H.length+z.length,function(t,e,n){X+="'"+x(t,e,n)+"',"}),X.length>3&&(Z+="("+X,Z=t.trim(Z).substring(0,Z.length-1),Z+="),"),K++}),Z=t.trim(Z).substring(0,Z.length-1),Z+=";",W.consoleLog===!0&&console.log(Z),"string"===W.outputMode)return Z;if("base64"===W.outputMode)return P(Z);try{O=new Blob([Z],{type:"text/plain;charset=utf-8"}),saveAs(O,W.fileName+".sql")}catch(J){L(W.fileName+".sql","data:application/sql;charset=utf-8,",Z)}}else if("json"==W.type){var te=[];Q=[],H=t(U).find("thead").first().find(W.theadSelector),H.each(function(){var t=[];d(this,"th,td",K,H.length,function(e,n,o){t.push(x(e,n,o))}),te.push(t)});var ee=[];z=o(t(U)),t(z).each(function(){var e={},n=0;d(this,"td,th",K,H.length+z.length,function(t,o,r){te.length?e[te[te.length-1][n]]=x(t,o,r):e[n]=x(t,o,r),n++}),t.isEmptyObject(e)===!1&&ee.push(e),K++});var ne="";if(ne=JSON.stringify("head"==W.jsonScope?te:"data"==W.jsonScope?ee:{header:te,data:ee}),W.consoleLog===!0&&console.log(ne),"string"===W.outputMode)return ne;if("base64"===W.outputMode)return P(ne);try{O=new Blob([ne],{type:"application/json;charset=utf-8"}),saveAs(O,W.fileName+".json")}catch(J){L(W.fileName+".json","data:application/json;charset=utf-8;base64,",ne)}}else if("xml"===W.type){K=0,Q=[];var oe='<?xml version="1.0" encoding="utf-8"?>';oe+="<tabledata><fields>",H=t(U).find("thead").first().find(W.theadSelector),H.each(function(){d(this,"th,td",K,H.length,function(t,e,n){oe+="<field>"+x(t,e,n)+"</field>"}),K++}),oe+="</fields><data>";var re=1;if(z=o(t(U)),t(z).each(function(){var t=1;X="",d(this,"td,th",K,H.length+z.length,function(e,n,o){X+="<column-"+t+">"+x(e,n,o)+"</column-"+t+">",t++}),X.length>0&&"<column-1></column-1>"!=X&&(oe+='<row id="'+re+'">'+X+"</row>",re++),K++}),oe+="</data></tabledata>",W.consoleLog===!0&&console.log(oe),"string"===W.outputMode)return oe;if("base64"===W.outputMode)return P(oe);try{O=new Blob([oe],{type:"application/xml;charset=utf-8"}),saveAs(O,W.fileName+".xml")}catch(J){L(W.fileName+".xml","data:application/xml;charset=utf-8;base64,",oe)}}else if("excel"===W.type&&"xmlss"===W.excelFileFormat){var ie=[],ae=[];t(U).filter(function(){return s(t(this))}).each(function(){function e(e,n,o){var r=[];return t(e).each(function(){var n=0,i=0;X="",d(this,"td,th",K,o+e.length,function(e,o,a){if(null!==e){var s="",l=x(e,o,a),c="String";if(jQuery.isNumeric(l)!==!1)c="Number";else{var d=b(l);d!==!1&&(l=d,c="Number",s+=' ss:StyleID="pct1"')}"Number"!==c&&(l=l.replace(/\n/g,"<br>"));var f=parseInt(e.getAttribute("colspan")),h=parseInt(e.getAttribute("rowspan"));r.forEach(function(t){if(K>=t.s.r&&K<=t.e.r&&i>=t.s.c&&i<=t.e.c)for(var e=0;e<=t.e.c-t.s.c;++e)i++,n++}),(h||f)&&(h=h||1,f=f||1,r.push({s:{r:K,c:i},e:{r:K+h-1,c:i+f-1}})),f>1&&(s+=' ss:MergeAcross="'+(f-1)+'"',i+=f-1),h>1&&(s+=' ss:MergeDown="'+(h-1)+'" ss:StyleID="rsp1"'),n>0&&(s+=' ss:Index="'+(i+1)+'"',n=0),X+="<Cell"+s+'><Data ss:Type="'+c+'">'+t("<div />").text(l).html()+"</Data></Cell>\r",i++}}),X.length>0&&(ve+='<Row ss:AutoFitHeight="0">\r'+X+"</Row>\r"),K++}),e.length}var n=t(this),r="";"string"==typeof W.worksheetName&&W.worksheetName.length?r=W.worksheetName+" "+(ae.length+1):"undefined"!=typeof W.worksheetName[ae.length]&&(r=W.worksheetName[ae.length]),r.length||(r=n.find("caption").text()||""),r.length||(r="Table "+(ae.length+1)),r=r.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31).trim(),ae.push(t("<div />").text(r).html()),W.exportHiddenCells===!1&&(V=n.find("tr, th, td").filter(":hidden"),Y=V.length>0),K=0,q=a(this),ve="<Table>\r";var i=0;i+=e(n.find("thead").first().find(W.theadSelector),"th,td",i),e(o(n),"td,th",i),ve+="</Table>\r",ie.push(ve),W.consoleLog===!0&&console.log(ve)});for(var se,le,ce={},de={},fe=0,he=ae.length;he>fe;fe++)se=ae[fe],le=ce[se],le=ce[se]=null==le?1:le+1,2==le&&(ae[de[se]]=ae[de[se]].substring(0,29)+"-1"),ce[se]>1?ae[fe]=ae[fe].substring(0,29)+"-"+ce[se]:de[se]=fe;for(var ue=(new Date).toISOString(),pe='<?xml version="1.0" encoding="UTF-8"?>\r<?mso-application progid="Excel.Sheet"?>\r<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:o="urn:schemas-microsoft-com:office:office"\r xmlns:x="urn:schemas-microsoft-com:office:excel"\r xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:html="http://www.w3.org/TR/REC-html40">\r<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\r  <Created>'+ue+'</Created>\r</DocumentProperties>\r<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">\r  <AllowPNG/>\r</OfficeDocumentSettings>\r<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\r  <WindowHeight>9000</WindowHeight>\r  <WindowWidth>13860</WindowWidth>\r  <WindowTopX>0</WindowTopX>\r  <WindowTopY>0</WindowTopY>\r  <ProtectStructure>False</ProtectStructure>\r  <ProtectWindows>False</ProtectWindows>\r</ExcelWorkbook>\r<Styles>\r  <Style ss:ID="Default" ss:Name="Normal">\r    <Alignment ss:Vertical="Bottom"/>\r    <Borders/>\r    <Font/>\r    <Interior/>\r    <NumberFormat/>\r    <Protection/>\r  </Style>\r  <Style ss:ID="rsp1">\r    <Alignment ss:Vertical="Center"/>\r  </Style>\r  <Style ss:ID="pct1">\r    <NumberFormat ss:Format="Percent"/>\r  </Style>\r</Styles>\r',ge=0;ge<ie.length;ge++)pe+='<Worksheet ss:Name="'+ae[ge]+'" ss:RightToLeft="'+(W.excelRTL?"1":"0")+'">\r'+ie[ge],pe+=W.excelRTL?'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\r<DisplayRightToLeft/>\r</WorksheetOptions>\r':'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"/>\r',pe+="</Worksheet>\r";if(pe+="</Workbook>\r",W.consoleLog===!0&&console.log(pe),"string"===W.outputMode)return pe;if("base64"===W.outputMode)return P(pe);try{O=new Blob([pe],{type:"application/xml;charset=utf-8"}),saveAs(O,W.fileName+".xml")}catch(J){L(W.fileName+".xml","data:application/xml;charset=utf-8;base64,",pe)}}else if("excel"==W.type||"xls"==W.type||"word"==W.type||"doc"==W.type){var me="excel"==W.type||"xls"==W.type?"excel":"word",ye="excel"==me?"xls":"doc",we='xmlns:x="urn:schemas-microsoft-com:office:'+me+'"',ve="",be="";t(U).filter(function(){return s(t(this))}).each(function(){var e=t(this);""===be&&(be=W.worksheetName||e.find("caption").text()||"Table",be=be.replace(/[\\\/[\]*:?'"]/g,"").substring(0,31).trim()),W.exportHiddenCells===!1&&(V=e.find("tr, th, td").filter(":hidden"),Y=V.length>0),K=0,Q=[],q=a(this),ve+="<table><thead>",H=e.find("thead").first().find(W.theadSelector),H.each(function(){X="",d(this,"th,td",K,H.length,function(e,n,o){if(null!==e){var r="";X+="<th";for(var i in W.excelstyles)if(W.excelstyles.hasOwnProperty(i)){var a=t(e).css(W.excelstyles[i]);""!==a&&"0px none rgb(0, 0, 0)"!=a&&"rgba(0, 0, 0, 0)"!=a&&(r+=""===r?'style="':";",r+=W.excelstyles[i]+":"+a)}""!==r&&(X+=" "+r+'"'),t(e).is("[colspan]")&&(X+=' colspan="'+t(e).attr("colspan")+'"'),t(e).is("[rowspan]")&&(X+=' rowspan="'+t(e).attr("rowspan")+'"'),X+=">"+x(e,n,o)+"</th>"}}),X.length>0&&(ve+="<tr>"+X+"</tr>"),K++}),ve+="</thead><tbody>",z=o(e),t(z).each(function(){var e=t(this);X="",d(this,"td,th",K,H.length+z.length,function(n,o,r){if(null!==n){var i=x(n,o,r),a="",s=t(n).data("tableexport-msonumberformat");"undefined"==typeof s&&"function"==typeof W.onMsoNumberFormat&&(s=W.onMsoNumberFormat(n,o,r)),"undefined"!=typeof s&&""!==s&&(a="style=\"mso-number-format:'"+s+"'");for(var l in W.excelstyles)W.excelstyles.hasOwnProperty(l)&&(s=t(n).css(W.excelstyles[l]),""===s&&(s=e.css(W.excelstyles[l])),""!==s&&"0px none rgb(0, 0, 0)"!=s&&"rgba(0, 0, 0, 0)"!=s&&(a+=""===a?'style="':";",a+=W.excelstyles[l]+":"+s));X+="<td",""!==a&&(X+=" "+a+'"'),t(n).is("[colspan]")&&(X+=' colspan="'+t(n).attr("colspan")+'"'),t(n).is("[rowspan]")&&(X+=' rowspan="'+t(n).attr("rowspan")+'"'),"string"==typeof i&&""!=i&&(i=i.replace(/\n/g,"<br>")),X+=">"+i+"</td>"}}),X.length>0&&(ve+="<tr>"+X+"</tr>"),K++}),W.displayTableName&&(ve+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+x(t("<p>"+W.tableName+"</p>"))+"</td></tr>"),ve+="</tbody></table>",W.consoleLog===!0&&console.log(ve)});var xe='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+we+' xmlns="http://www.w3.org/TR/REC-html40">';if(xe+='<meta http-equiv="content-type" content="application/vnd.ms-'+me+'; charset=UTF-8">',xe+="<head>","excel"===me&&(xe+="<!--[if gte mso 9]>",xe+="<xml>",xe+="<x:ExcelWorkbook>",xe+="<x:ExcelWorksheets>",xe+="<x:ExcelWorksheet>",xe+="<x:Name>",xe+=be,xe+="</x:Name>",xe+="<x:WorksheetOptions>",xe+="<x:DisplayGridlines/>",W.excelRTL&&(xe+="<x:DisplayRightToLeft/>"),xe+="</x:WorksheetOptions>",xe+="</x:ExcelWorksheet>",xe+="</x:ExcelWorksheets>",xe+="</x:ExcelWorkbook>",xe+="</xml>",xe+="<![endif]-->"),xe+="<style>br {mso-data-placement:same-cell;}</style>",xe+="</head>",xe+="<body>",xe+=ve,xe+="</body>",xe+="</html>",W.consoleLog===!0&&console.log(xe),"string"===W.outputMode)return xe;if("base64"===W.outputMode)return P(xe);try{O=new Blob([xe],{type:"application/vnd.ms-"+W.type}),saveAs(O,W.fileName+"."+ye)}catch(J){L(W.fileName+"."+ye,"data:application/vnd.ms-"+me+";base64,",xe)}}else if("xlsx"==W.type){var Se=[],Ce=[];K=0,z=t(U).find("thead").first().find(W.theadSelector),z.push.apply(z,o(t(U))),t(z).each(function(){var t=[];d(this,"th,td",K,z.length,function(e,n,o){if("undefined"!=typeof e&&null!==e){var r=x(e,n,o),i=parseInt(e.getAttribute("colspan")),a=parseInt(e.getAttribute("rowspan"));if(Ce.forEach(function(e){if(K>=e.s.r&&K<=e.e.r&&t.length>=e.s.c&&t.length<=e.e.c)for(var n=0;n<=e.e.c-e.s.c;++n)t.push(null)}),(a||i)&&(a=a||1,i=i||1,Ce.push({s:{r:K,c:t.length},e:{r:K+a-1,c:t.length+i-1}})),"function"!=typeof W.onCellData&&""!==r&&r==+r&&(r=+r),t.push(""!==r?r:null),i)for(var s=0;i-1>s;++s)t.push(null)}}),Se.push(t),K++});var ke=new R,Ne=j(Se);Ne["!merges"]=Ce,ke.SheetNames.push(W.worksheetName),ke.Sheets[W.worksheetName]=Ne;var Ae=XLSX.write(ke,{bookType:W.type,bookSST:!1,type:"binary"});try{O=new Blob([I(Ae)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"}),saveAs(O,W.fileName+"."+W.type)}catch(J){L(W.fileName+"."+W.type,"data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8,",I(Ae))}}else if("png"==W.type)html2canvas(t(U)[0],{onrendered:function(t){for(var e=t.toDataURL(),n=atob(e.substring(22)),o=new ArrayBuffer(n.length),r=new Uint8Array(o),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);if(W.consoleLog===!0&&console.log(n),"string"===W.outputMode)return n;if("base64"===W.outputMode)return P(e);if("window"===W.outputMode)return void window.open(e);try{O=new Blob([o],{type:"image/png"}),saveAs(O,W.fileName+".png")}catch(a){L(W.fileName+".png","data:image/png,",O)}}});else if("pdf"==W.type)if(W.pdfmake.enabled===!0){var Te=[],Re=[];K=0,Q=[];var Ie=function(e,n,o){var r=0;return t(e).each(function(){var t=[];d(this,n,K,o,function(e,n,o){if("undefined"!=typeof e&&null!==e){var r=parseInt(e.getAttribute("colspan")),i=parseInt(e.getAttribute("rowspan")),a=x(e,n,o)||" ";r>1||i>1?(r=r||1,i=i||1,t.push({colSpan:r,rowSpan:i,text:a})):t.push(a)}else t.push(" ")}),t.length&&Re.push(t),r<t.length&&(r=t.length),K++}),r};H=t(this).find("thead").first().find(W.theadSelector);for(var Ee=Ie(H,"th,td",H.length),je=Te.length;Ee>je;je++)Te.push("*");z=o(t(this)),Ie(z,"th,td",H.length+z.length);var De={content:[{table:{headerRows:H.length,widths:Te,body:Re}}]};t.extend(!0,De,W.pdfmake.docDefinition),pdfMake.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"}},t.extend(!0,pdfMake.fonts,W.pdfmake.fonts),pdfMake.createPdf(De).getBuffer(function(t){try{var e=new Blob([t],{type:"application/pdf"});saveAs(e,W.fileName+".pdf")}catch(n){L(W.fileName+".pdf","data:application/pdf;base64,",t)}})}else if(W.jspdf.autotable===!1){var Le={dim:{w:T(t(U).first().get(0),"width","mm"),h:T(t(U).first().get(0),"height","mm")},pagesplit:!1},Me=new jsPDF(W.jspdf.orientation,W.jspdf.unit,W.jspdf.format);Me.addHTML(t(U).first(),W.jspdf.margins.left,W.jspdf.margins.top,Le,function(){f(Me,!1)})}else{var Pe=W.jspdf.autotable.tableExport;if("string"==typeof W.jspdf.format&&"bestfit"===W.jspdf.format.toLowerCase()){var Oe={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},We="",Fe="",Ue=0;t(U).each(function(){if(s(t(this))){var e=T(t(this).get(0),"width","pt");if(e>Ue){e>Oe.a0[0]&&(We="a0",Fe="l");for(var n in Oe)Oe.hasOwnProperty(n)&&Oe[n][1]>e&&(We=n,Fe="l",Oe[n][0]>e&&(Fe="p"));Ue=e}}}),W.jspdf.format=""===We?"a4":We,W.jspdf.orientation=""===Fe?"w":Fe}null==Pe.doc&&(Pe.doc=new jsPDF(W.jspdf.orientation,W.jspdf.unit,W.jspdf.format),"function"==typeof W.jspdf.onDocCreated&&W.jspdf.onDocCreated(Pe.doc)),Pe.outputImages===!0&&(Pe.images={}),"undefined"!=typeof Pe.images&&(t(U).filter(function(){return s(t(this))}).each(function(){var e=0;Q=[],W.exportHiddenCells===!1&&(V=t(this).find("tr, th, td").filter(":hidden"),Y=V.length>0),H=t(this).find("thead").find(W.theadSelector),z=o(t(this)),t(z).each(function(){d(this,"td,th",H.length+e,H.length+z.length,function(e){if("undefined"!=typeof e&&null!==e){var n=t(e).children();"undefined"!=typeof n&&n.length>0&&u(e,n,Pe)}}),e++})}),H=[],z=[]),p(Pe,function(){t(U).filter(function(){return s(t(this))}).each(function(){var e;if(K=0,Q=[],W.exportHiddenCells===!1&&(V=t(this).find("tr, th, td").filter(":hidden"),Y=V.length>0),q=a(this),Pe.columns=[],Pe.rows=[],Pe.rowoptions={},"function"==typeof Pe.onTable&&Pe.onTable(t(this),W)===!1)return!0;W.jspdf.autotable.tableExport=null;var n=t.extend(!0,{},W.jspdf.autotable);if(W.jspdf.autotable.tableExport=Pe,n.margin={},t.extend(!0,n.margin,W.jspdf.margins),n.tableExport=Pe,"function"!=typeof n.beforePageContent&&(n.beforePageContent=function(t){if(1==t.pageCount){var e=t.table.rows.concat(t.table.headerRow);e.forEach(function(e){e.height>0&&(e.height+=(2-F)/2*e.styles.fontSize,t.table.height+=(2-F)/2*e.styles.fontSize)})}}),"function"!=typeof n.createdHeaderCell&&(n.createdHeaderCell=function(e,o){if(e.styles=t.extend({},o.row.styles),"undefined"!=typeof Pe.columns[o.column.dataKey]){var r=Pe.columns[o.column.dataKey];if("undefined"!=typeof r.rect){var i;e.contentWidth=r.rect.width,("undefined"==typeof Pe.heightRatio||0===Pe.heightRatio)&&(i=o.row.raw[o.column.dataKey].rowspan?o.row.raw[o.column.dataKey].rect.height/o.row.raw[o.column.dataKey].rowspan:o.row.raw[o.column.dataKey].rect.height,Pe.heightRatio=e.styles.rowHeight/i),i=o.row.raw[o.column.dataKey].rect.height*Pe.heightRatio,i>e.styles.rowHeight&&(e.styles.rowHeight=i)}"undefined"!=typeof r.style&&r.style.hidden!==!0&&(e.styles.halign=r.style.align,"inherit"===n.styles.fillColor&&(e.styles.fillColor=r.style.bcolor),"inherit"===n.styles.textColor&&(e.styles.textColor=r.style.color),"inherit"===n.styles.fontStyle&&(e.styles.fontStyle=r.style.fstyle))}}),"function"!=typeof n.createdCell&&(n.createdCell=function(t,e){var o=Pe.rowoptions[e.row.index+":"+e.column.dataKey];"undefined"!=typeof o&&"undefined"!=typeof o.style&&o.style.hidden!==!0&&(t.styles.halign=o.style.align,"inherit"===n.styles.fillColor&&(t.styles.fillColor=o.style.bcolor),"inherit"===n.styles.textColor&&(t.styles.textColor=o.style.color),"inherit"===n.styles.fontStyle&&(t.styles.fontStyle=o.style.fstyle))}),"function"!=typeof n.drawHeaderCell&&(n.drawHeaderCell=function(t,e){var n=Pe.columns[e.column.dataKey];return(n.style.hasOwnProperty("hidden")!==!0||n.style.hidden!==!0)&&n.rowIndex>=0?h(t,e,n):!1}),"function"!=typeof n.drawCell&&(n.drawCell=function(t,e){var n=Pe.rowoptions[e.row.index+":"+e.column.dataKey];if(h(t,e,n))if(Pe.doc.rect(t.x,t.y,t.width,t.height,t.styles.fillStyle),"undefined"!=typeof n&&"undefined"!=typeof n.kids&&n.kids.length>0){var o=t.height/n.rect.height;(o>Pe.dh||"undefined"==typeof Pe.dh)&&(Pe.dh=o),Pe.dw=t.width/n.rect.width;var r=t.textPos.y;g(t,n.kids,Pe),t.textPos.y=r,m(t,n.kids,Pe)}else m(t,{},Pe);return!1}),Pe.headerrows=[],H=t(this).find("thead").find(W.theadSelector),H.each(function(){e=0,Pe.headerrows[K]=[],d(this,"th,td",K,H.length,function(t,n,o){var r=k(t);r.title=x(t,n,o),r.key=e++,r.rowIndex=K,Pe.headerrows[K].push(r)}),K++}),K>0)for(var r=K-1;r>=0;)t.each(Pe.headerrows[r],function(){var t=this;r>0&&null===this.rect&&(t=Pe.headerrows[r-1][this.key]),null!==t&&t.rowIndex>=0&&(t.style.hasOwnProperty("hidden")!==!0||t.style.hidden!==!0)&&Pe.columns.push(t)}),r=Pe.columns.length>0?-1:r-1;var i=0;z=[],z=o(t(this)),t(z).each(function(){var n=[];e=0,d(this,"td,th",K,H.length+z.length,function(o,r,a){var s;"undefined"==typeof Pe.columns[e]&&(s={title:"",key:e,style:{hidden:!0}},Pe.columns.push(s)),"undefined"!=typeof o&&null!==o?(s=k(o),s.kids=t(o).children(),Pe.rowoptions[i+":"+e++]=s):(s=t.extend(!0,{},Pe.rowoptions[i+":"+(e-1)]),s.colspan=-1,Pe.rowoptions[i+":"+e++]=s),n.push(x(o,r,a))
}),n.length&&(Pe.rows.push(n),i++),K++}),"function"==typeof Pe.onBeforeAutotable&&Pe.onBeforeAutotable(t(this),Pe.columns,Pe.rows,n),Pe.doc.autoTable(Pe.columns,Pe.rows,n),"function"==typeof Pe.onAfterAutotable&&Pe.onAfterAutotable(t(this),n),W.jspdf.autotable.startY=Pe.doc.autoTableEndPosY()+n.margin.top}),f(Pe.doc,"undefined"!=typeof Pe.images&&jQuery.isEmptyObject(Pe.images)===!1),"undefined"!=typeof Pe.headerrows&&(Pe.headerrows.length=0),"undefined"!=typeof Pe.columns&&(Pe.columns.length=0),"undefined"!=typeof Pe.rows&&(Pe.rows.length=0),delete Pe.doc,Pe.doc=null})}return this}})}(jQuery);